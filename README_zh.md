# P523-Rust
P523 经典编译器课程的 Rust 引导

P523 是一门经典的编译器课程，由 chez-scheme 的作者，R. Kent Dybvig 和他的助手教授。十年过去了，还有人想学习这门课程。

![](./hacker-news.png)

Kent 是谁？

> 如果你上了 Kent 的课，再来看看普通的编译器书籍（比如有名的 Dragon Book），或者 LLVM 的代码，你就会发现 Kent 的水平其实远在这些知名的大牛之上。我为什么可以这么说呢？因为如果你的水平不如这些人的话，你自己都会对这种判断产生怀疑。而如果你超过了别人，他们的一言一行，他们的每一个错误，都像是处于你的显微镜底下，看得一清二楚。这就是为什么有一天我拿起 Dragon Book，感觉它变得那么的幼稚。而其实并不是它变幼稚了，而是我变成熟了。实话实说吧，在编译器这个领域，我觉得 Kent 很有可能就是世界的 No.1。—— Chez Scheme 的传说


这里是基于 P523 的一个 Rust 作业框架及引导，供爱好者取用。为了提振信心，可以读一读王垠的 [Chez Scheme 的传说](http://www.yinwang.org/blog-cn/2013/03/28/chez-scheme)。

> Kent 的课程编译器有很好的结构，它被叫做“nanopass 编译器构架”。它的每一个 pass 只做很小的一件事情，然后这些 pass 被串联起来，形成一个完整的编译器。编译的过程，就是将输入程序经过一系列的变换之后，转化为机器代码。你也许发现了，这在本质上跟 LLVM 的构架是一样的。但是我可以告诉你，我们的课程编译器比 LLVM 干净利落许多，处于远远领先的地位。—— Chez Scheme 的传说


### 初心

见 [Rust-One-Piece](https://zhuanlan.zhihu.com/p/259594199) 初心部分。

以及[倔强的程序员](https://zhuanlan.zhihu.com/p/165524567)


### 准备

+ Rust Nightly
+ GCC

Rust 起码读了一遍 the book 。

当然，如果你想尝试原汁原味的 P523，可以试试[这个](https://github.com/siriusdemon/iub_2009_P523_framework)，热心人士所整理。

### 通关流程

0. 阅读 Kent 的讲义
1. 看看 syntax 的变化
2. 看看 parser 的变化（可选）
3. 修改 compiler
4. 增减 test

### 至关重要的通关提示

关于你的
+ 每个关卡开始前，仔细读一读 P523 对应的 PDF，不然你会不知道我在说什么。
+ 进入新的关卡，第一件事是`cargo run`。
+ 学而不思则罔，思而不码则殆。
+ 每写完一个 pass，run 一下看看结果是否符合预期。

关于我的
+ 当我的引导与 P523 中有说的不同，而我又没有明确说明时，很可能是我错了，也许是我忘记了。请让我知道。
+ 将我的代码看成`90%`正确的，也许会是错的。
+ 当你参考我的代码实现时，有时候会遇到比较 naive 但能 work 的代码，通常我会说明。这些代码也必定会在后续的代码中被完善。


### 博客

+ [a1](./blog/a1.md)
+ [a2](./blog/a2.md)
+ [a3](./blog/a3.md)
+ [a4](./blog/a4.md)
+ [a5](./blog/a5.md)
+ [a6](./blog/a6.md)

### Final

理想开花，桃李要结甜果；

理想抽芽，榆杨会有浓荫。

请乘理想之马，挥鞭从此启程，

路上春色正好，天上太阳正晴。
<!-- 
1 恰同学少年，风华正茂，书生意气，挥斥方遒。
2 黑夜给了我黑色的眼睛，我却用它来寻找光明。
3 学而不思则罔，思而不学则殆。
4 士不可以不弘毅，任重而道远。仁以为己任，不亦重乎？死而后已，不亦远乎？
5 我之所以坚定地相信未来，是我相信未来人们的眼睛。她有拨开历史风尘的睫毛，她有看透岁月篇章的瞳孔。
6 骐骥一跃，不能十步。驽马十驾，功在不舍。
7 天下事有难易乎？为之，则难者亦易矣；不为，则易者亦难矣。人之为学有难易乎？学之，则难者亦易矣；不学，则易者亦难矣。
8 艰难困苦，玉汝于成。
9 如果海洋注定要决堤，就让所有的苦水都注入我心中；如果陆地注定要上升，就让人类重新选择生存的峰顶。
10 横眉冷对千夫指，俯首甘为孺子牛。
11 愚蠢的人中，也会有有钱人。野兽之中，也有些是英勇的。但是，在这个世界上，博学多闻，举止温柔者少之又少，因此，请修持温柔者的道德伦常。
12 愿我走过的苦难，你不必经历，愿我已有的幸福，你触手可及。
13 给每一条河每一座山取一个温暖的名字。陌生人，我也为你祝福。
14 我不去想，未来是平坦还是泥泞，只要热爱生命 ，一切都在意料之中。
15 俱往矣，数风流人物，还看今朝。


 -->
